robust_se <- sqrt(diag(vcovHC(teachers_access_ols, type = "HC3")))
teachers_access_ols_table <- stargazer(teachers_access_ols,
report="vcsp",
type="html",
out="teachers_access_ols_table_robust_errors.html",
# covariate.labels = c(),
# dep.var.labels = "",
title = "Results of OLS regresion",
se= list(robust_se))
#Join residuals
residuals_teacher_access <- resid(teachers_access_ols)
residuals_df <- as.data.frame(residuals_teacher_access)
data <- cbind(data, residuals_df)
#Join predicted values
predicted_y_teacher_access <- predict(teachers_access_ols)
predicted_df <- as.data.frame(predicted_y_teacher_access)
data <- cbind(data, predicted_df)
#Test spatial autocorrelation
data_moran <- data
coords_matrix <- as.matrix(data_moran[, c("centroid_x", "centroid_y")])
neighbors <- knearneigh(coords_matrix, k = 4)
nb <- knn2nb(neighbors)
lw <- nb2listw(nb, style = "W")  # row-standardized weights
moran_test_teacher_access <- moran.test(data_moran$residuals_teacher_access, lw)
#The residuals are heteroskedastic. So we infer using the robust errors. However,
#the Moran test is not significant. So, we keep it at that.
#--------------------------------------------------------------------------
#Teacher per school
data_centered <- data
data_centered$rate_lang_non_bg = data_centered$rate_lang_non_bg - mean(data_centered$rate_lang_non_bg)
data_centered$log_average_salary = log(data_centered$average_salary) - mean(log(data_centered$average_salary))
data_centered$rate_pop_school_age = data_centered$rate_pop_school_age - mean(data_centered$rate_pop_school_age)
data_centered$deprivation_rate = data_centered$deprivation_rate - mean(data_centered$deprivation_rate)
data_centered$log_population = data_centered$log_population - mean(data_centered$log_population)
data_centered$rate_city_pop = data_centered$rate_city_pop - mean(data_centered$rate_city_pop)
data_centered$popul_density = data_centered$popul_density - mean(data_centered$popul_density)
teachers_per_school_ols <- lm(teachers_per_school ~
percentage_roma +
log_average_salary +
rate_pop_school_age +
deprivation_rate +
rate_city_pop +
popul_density +
log_population,
data = data_centered)
teachers_per_school_ols_table <- stargazer(teachers_per_school_ols,
report="vcsp",
type="html",
out="teachers_per_school_ols_table.html",
# covariate.labels = c(),
# dep.var.labels = "",
title = "Results of OLS regresion")
#teachers_per_school_aic <- AIC(teachers_per_school_ols,
#                               teachers_per_school_ols_simple)
#teachers_per_school_bic <- BIC(teachers_per_school_ols,
#                               teachers_per_school_ols_simple)
models <- list(
Model1 = teachers_per_school_ols
)
teachers_per_school_vif <- models %>%
map(get_vif_df) %>%
bind_rows(.id = "Model") %>%
pivot_wider(
names_from = Model,
values_from = -Variable,
values_fill = NA
)
#heteroskedasticity test
bptest_teacher_per_school <- bptest(teachers_per_school_ols)
#Join residuals
residuals_teachers_per_school <- resid(teachers_per_school_ols)
residuals_df <- as.data.frame(residuals_teachers_per_school)
data <- cbind(data, residuals_df)
#Join predicted values
predicted_y_teachers_per_school  <- predict(teachers_per_school_ols)
predicted_df <- as.data.frame(predicted_y_teachers_per_school )
data <- cbind(data, predicted_df)
#Test spatial autocorrelation
data_moran <- data
coords_matrix <- as.matrix(data_moran[, c("centroid_x", "centroid_y")])
neighbors <- knearneigh(coords_matrix, k = 4)
nb <- knn2nb(neighbors)
lw <- nb2listw(nb, style = "W")  # row-standardized weights
moran_test_teacher_per_school <- moran.test(data_moran$residuals_teachers_per_school, lw)
#Both the BP and the Moran I tests are not significant. Which means that
#we keep the results of the OLS and we map those out
#--------------------------------------------------------------------------
#Crime rate regression
data_crime <- data
data_crime$log_population <- log(data_crime$total_population)
data_centered <- data_crime
data_centered$percentage_roma = data_centered$percentage_roma - mean(data_centered$percentage_roma)
data_centered$log_average_salary = log(data_centered$average_salary) - mean(log(data_centered$average_salary))
data_centered$employment_rate = data_centered$employment_rate - mean(data_centered$employment_rate)
data_centered$rate_pop_school_age = data_centered$rate_pop_school_age - mean(data_centered$rate_pop_school_age)
data_centered$deprivation_rate = data_centered$deprivation_rate - mean(data_centered$deprivation_rate)
data_centered$without_secondary = data_centered$without_secondary - mean(data_centered$without_secondary)
data_centered$log_population = data_centered$log_population - mean(data_centered$log_population)
crime_rate_ols <- lm(crime_per_1000 ~
percentage_roma +
log_average_salary +
employment_rate +
rate_pop_school_age +
deprivation_rate +
log_population +
without_secondary,
data = data_centered)
crime_rate_ols_table <- stargazer(crime_rate_ols,
report="vcsp",
type="html",
out="crime_rate_ols_table.html",
# covariate.labels = c(),
# dep.var.labels = "",
title = "Results of OLS regresion")
#crime_rate_aic <- AIC(crime_rate_ols,
#                      crime_rate_ols_simple)
#crime_rate_bic <- BIC(crime_rate_ols,
#                      crime_rate_ols_simple)
models <- list(
Model1 = crime_rate_ols
)
crime_rate_vif <- models %>%
map(get_vif_df) %>%
bind_rows(.id = "Model") %>%
pivot_wider(
names_from = Model,
values_from = -Variable,
values_fill = NA
)
#heteroskedasticity test
bptest_crime_rate <- bptest(crime_rate_ols)
#Bad regression with low R squared. Many reasons for that. No real explanation
#behind crime rates. No statistical proof that the Roma contribute.
#Heteroskedastic residuals on top of everything.
#No furhter proceedings.
#--------------------------------------------------------------------------
#PCA computing
data_pca <- data
data_pca$rate_children = (data_pca$pop_children_total / data_pca$total_population) * 100
data_pca$rate_over_65 = (data_pca$pop_over_65 / data_pca$total_population) * 100
data_centered <- data_pca
data_centered$without_secondary = data_centered$without_secondary - mean(data_centered$without_secondary)
data_centered$unemployment_rate = data_centered$unemployment_rate - mean(data_centered$unemployment_rate)
data_centered$crime_per_1000 = data_centered$crime_per_1000 - mean(data_centered$crime_per_1000)
data_centered$doctors_1000 = data_centered$doctors_1000 - mean(data_centered$doctors_1000)
data_centered$deprivation_rate = data_centered$deprivation_rate - mean(data_centered$deprivation_rate)
pca_data <- data_centered %>% select(GISCO_ID, without_secondary, unemployment_rate, crime_per_1000, doctors_1000, deprivation_rate)
pca_data_noid <- pca_data %>% select(without_secondary, unemployment_rate, crime_per_1000, doctors_1000, deprivation_rate)
pca_data_nomissing <- na.omit(pca_data_noid)
pca_data_numeric <- pca_data_nomissing %>% mutate(across(everything(), ~ as.numeric(as.character(.))))
pca_data_scaled <- scale(pca_data_numeric)
pca_result <- prcomp(pca_data_scaled, center = TRUE, scale. = TRUE)
summary(pca_result)
pca_result$rotation  # Loadings (variable contributions)
pc1 <- pca_result$x[,1]
pc1_scores <- pca_data %>% select(GISCO_ID) %>% mutate(pca_comp1 = pc1)
data <- data %>% left_join(pc1_scores, by="GISCO_ID")
data_pca <- data
data_pca$rate_children = (data_pca$pop_children_total / data_pca$total_population) * 100
data_pca$rate_over_65 = (data_pca$pop_over_65 / data_pca$total_population) * 100
data_centered <- data_pca
data_centered$rate_lang_non_bg = data_centered$rate_lang_non_bg - mean(data_centered$rate_lang_non_bg)
data_centered$log_average_salary = log(data_centered$average_salary) - mean(log(data_centered$average_salary))
data_centered$avg_household_size = data_centered$avg_household_size - mean(data_centered$avg_household_size)
data_centered$rate_children = data_centered$rate_children - mean(data_centered$rate_children)
data_centered$rate_over_65 = data_centered$rate_over_65 - mean(data_centered$rate_over_65)
data_centered$rate_city_pop = data_centered$rate_city_pop - mean(data_centered$rate_city_pop)
data_centered$popul_density = data_centered$popul_density - mean(data_centered$popul_density)
pca_ols <- lm(pca_comp1 ~
percentage_roma +
log_average_salary +
avg_household_size +
rate_children +
rate_over_65 +
rate_city_pop +
popul_density,
data = data_centered)
pca_ols_table <- stargazer(pca_ols,
report="vcsp",
type="html",
out="pca_ols_table.html",
# covariate.labels = c(),
# dep.var.labels = "",
title = "Results of OLS regresion")
#pca_aic <- AIC(pca_ols,
#               pca_ols_simple)
#pca_bic <- BIC(pca_ols,
#               pca_ols_simple)
models <- list(
Model1 = pca_ols
)
pca_vif <- models %>%
map(get_vif_df) %>%
bind_rows(.id = "Model") %>%
pivot_wider(
names_from = Model,
values_from = -Variable,
values_fill = NA
)
#heteroskedasticity test
bptest_pca <- bptest(pca_ols)
#displaying with robust errors
robust_se <- sqrt(diag(vcovHC(pca_ols, type = "HC3")))
pca_ols_table <- stargazer(pca_ols,
report="vcsp",
type="html",
out="pca_ols_table_robust_errors.html",
# covariate.labels = c(),
# dep.var.labels = "",
title = "Results of OLS regresion",
se= list(robust_se))
#Join residuals
residuals_pca <- resid(pca_ols)
residuals_df <- as.data.frame(residuals_pca)
data <- cbind(data, residuals_df)
#Join predicted values
predicted_y_pca <- predict(pca_ols)
predicted_df <- as.data.frame(predicted_y_pca)
data <- cbind(data, predicted_df)
#Test spatial autocorrelation
data_moran <- data
coords_matrix <- as.matrix(data_moran[, c("centroid_x", "centroid_y")])
neighbors <- knearneigh(coords_matrix, k = 4)
nb <- knn2nb(neighbors)
lw <- nb2listw(nb, style = "W")  # row-standardized weights
moran_test_pca <- moran.test(data_moran$residuals_pca, lw)
#Both BP and Moran I tests are significant, which means heteroskedastic and
#spatially non-stationary. We need to do a geographic analysis
data <- data %>% select(-GISCO_ID, -CNTR_CODE, -POP_2024, -POP_DENS_2, -AREA_KM2, -YEAR)
write_csv(data, "data/bulgaria_data_regressions.csv")
if(!("sf" %in% installed.packages()[,"Package"])) install.packages("sf")
library(sf)
if(!("spdep" %in% installed.packages()[,"Package"])) install.packages("spdep")
library(spdep)
if(!("dplyr" %in% installed.packages()[,"Package"])) install.packages("dplyr")
library(dplyr)
if(!("readr" %in% installed.packages()[,"Package"])) install.packages("readr")
library("readr")
#SET WORKING DIRECTORY
#setwd("")
data <- read.csv("data/bulgaria_data_regressions.csv")
data_sf <- st_as_sf(data, coords = c("centroid_x", "centroid_y"), crs = 4326)
data_sp <- as(data_sf, "Spatial")
coords_matrix <- as.matrix(data[, c("centroid_x", "centroid_y")])
neighbors <- knearneigh(coords_matrix, k = 4)
nb <- knn2nb(neighbors)
lw <- nb2listw(nb, style = "W")  # row-standardized weights
moran_test_roma <- moran.test(data$percentage_roma, lw)
moran_test_rate_lang_non_bg <- moran.test(data$rate_lang_non_bg, lw)
#Without secondary with roma percentage as X
lisa_without_secondary <- localmoran(data_sp$residuals_without_secondary, lw)
lisa_without_secondary_df <- as.data.frame(lisa_without_secondary)
lisa_without_secondary_df <- lisa_without_secondary_df %>% select(-Ii, -E.Ii, -Var.Ii, -Z.Ii)
colnames(lisa_without_secondary_df) <- c("lisa_without_secondary_p_value")
data <- bind_cols(data, lisa_without_secondary_df)
data <- data %>%
mutate(
res_std_without_secondary = scale(data$residuals_without_secondary)[,1],
lag_res_without_secondary = lag.listw(lw, data$residuals_without_secondary),
lag_std_without_secondary = scale(lag_res_without_secondary)[,1],
cluster_without_secondary = case_when(
res_std_without_secondary > 0 & lag_std_without_secondary > 0 & lisa_without_secondary_p_value <= 0.05 ~ "High-High",
res_std_without_secondary < 0 & lag_std_without_secondary < 0 & lisa_without_secondary_p_value <= 0.05 ~ "Low-Low",
res_std_without_secondary > 0 & lag_std_without_secondary < 0 & lisa_without_secondary_p_value <= 0.05 ~ "High-Low",
res_std_without_secondary < 0 & lag_std_without_secondary > 0 & lisa_without_secondary_p_value <= 0.05 ~ "Low-High",
TRUE ~ "Not significant"
)
)
#Without secondary with non BG speakers as X
lisa_without_secondary_tongues <- localmoran(data_sp$residuals_without_secondary_tongues, lw)
lisa_without_secondary_df_tongues <- as.data.frame(lisa_without_secondary_tongues)
lisa_without_secondary_df_tongues <- lisa_without_secondary_df_tongues %>% select(-Ii, -E.Ii, -Var.Ii, -Z.Ii)
colnames(lisa_without_secondary_df_tongues) <- c("lisa_without_secondary_tongues_p_value")
data <- bind_cols(data, lisa_without_secondary_df_tongues)
data <- data %>%
mutate(
res_std_without_secondary_tongues = scale(data$residuals_without_secondary_tongues)[,1],
lag_res_without_secondary_tongues = lag.listw(lw, data$residuals_without_secondary_tongues),
lag_std_without_secondary_tongues = scale(lag_res_without_secondary_tongues)[,1],
cluster_without_secondary_tongues = case_when(
res_std_without_secondary_tongues > 0 & lag_std_without_secondary_tongues > 0 & lisa_without_secondary_tongues_p_value <= 0.05 ~ "High-High",
res_std_without_secondary_tongues < 0 & lag_std_without_secondary_tongues < 0 & lisa_without_secondary_tongues_p_value <= 0.05 ~ "Low-Low",
res_std_without_secondary_tongues > 0 & lag_std_without_secondary_tongues < 0 & lisa_without_secondary_tongues_p_value <= 0.05 ~ "High-Low",
res_std_without_secondary_tongues < 0 & lag_std_without_secondary_tongues > 0 & lisa_without_secondary_tongues_p_value <= 0.05 ~ "Low-High",
TRUE ~ "Not significant"
)
)
#Roma LISA
lisa_roma <- localmoran(data_sp$percentage_roma, lw)
lisa_roma_df <- as.data.frame(lisa_roma)
lisa_roma_df <- lisa_roma_df %>% select(-Ii, -E.Ii, -Var.Ii, -Z.Ii)
colnames(lisa_roma_df) <- c("lisa_roma_p_value")
data <- bind_cols(data, lisa_roma_df)
data <- data %>%
mutate(
res_std_roma = scale(data$percentage_roma)[,1],
lag_res_roma = lag.listw(lw, data$percentage_roma),
lag_std_roma = scale(lag_res_roma)[,1],
cluster_roma = case_when(
res_std_roma > 0 & lag_std_roma > 0 & lisa_roma_p_value <= 0.05 ~ "High-High",
res_std_roma < 0 & lag_std_roma < 0 & lisa_roma_p_value <= 0.05 ~ "Low-Low",
res_std_roma > 0 & lag_std_roma < 0 & lisa_roma_p_value <= 0.05 ~ "High-Low",
res_std_roma < 0 & lag_std_roma > 0 & lisa_roma_p_value <= 0.05 ~ "Low-High",
TRUE ~ "Not significant"
)
)
#Non-Bulgarian speakers LISA
lisa_rate_lang_non_bg <- localmoran(data_sp$rate_lang_non_bg, lw)
lisa_rate_lang_non_bg_df <- as.data.frame(lisa_rate_lang_non_bg)
lisa_rate_lang_non_bg_df <- lisa_rate_lang_non_bg_df %>% select(-Ii, -E.Ii, -Var.Ii, -Z.Ii)
colnames(lisa_rate_lang_non_bg_df) <- c("lisa_rate_lang_non_bg_p_value")
data <- bind_cols(data, lisa_rate_lang_non_bg_df)
data <- data %>%
mutate(
res_std_rate_lang_non_bg = scale(data$rate_lang_non_bg)[,1],
lag_res_rate_lang_non_bg = lag.listw(lw, data$rate_lang_non_bg),
lag_std_rate_lang_non_bg = scale(lag_res_rate_lang_non_bg)[,1],
cluster_rate_lang_non_bg = case_when(
res_std_rate_lang_non_bg > 0 & lag_std_rate_lang_non_bg > 0 & lisa_rate_lang_non_bg_p_value <= 0.05 ~ "High-High",
res_std_rate_lang_non_bg < 0 & lag_std_rate_lang_non_bg < 0 & lisa_rate_lang_non_bg_p_value <= 0.05 ~ "Low-Low",
res_std_rate_lang_non_bg > 0 & lag_std_rate_lang_non_bg < 0 & lisa_rate_lang_non_bg_p_value <= 0.05 ~ "High-Low",
res_std_rate_lang_non_bg < 0 & lag_std_rate_lang_non_bg > 0 & lisa_rate_lang_non_bg_p_value <= 0.05 ~ "Low-High",
TRUE ~ "Not significant"
)
)
write_csv(data, "data/bulgaria_data_complete_lisa.csv")
if(!("sf" %in% installed.packages()[,"Package"])) install.packages("sf")
library(sf)
if(!("spdep" %in% installed.packages()[,"Package"])) install.packages("spdep")
library(spdep)
if(!("spatialreg" %in% installed.packages()[,"Package"])) install.packages("spatialreg")
library(spatialreg)
if(!("dplyr" %in% installed.packages()[,"Package"])) install.packages("dplyr")
library(dplyr)
if(!("knitr" %in% installed.packages()[,"Package"])) install.packages("knitr")
library(knitr)
if(!("kableExtra" %in% installed.packages()[,"Package"])) install.packages("kableExtra")
library(kableExtra)
#SET WORKING DIRECTORY
#setwd("")
data <- read.csv("data/bulgaria_data_regressions.csv")
data_sf <- st_as_sf(data, coords = c("centroid_x", "centroid_y"), crs = 4326)
data_sp <- as(data_sf, "Spatial")
coords_matrix <- as.matrix(data[, c("centroid_x", "centroid_y")])
neighbors <- knearneigh(coords_matrix, k = 4)
nb <- knn2nb(neighbors)
lw <- nb2listw(nb, style = "W")  # row-standardized weights
#Without secondary education regression
data_centered <- data
#Centering variables
data_centered$percentage_roma = data_centered$percentage_roma - mean(data_centered$percentage_roma)
data_centered$employment_rate = data_centered$employment_rate - mean(data_centered$employment_rate)
data_centered$teachers_1000_children = data_centered$teachers_1000_children - mean(data_centered$teachers_1000_children)
data_centered$rate_pop_school_age = data_centered$rate_pop_school_age - mean(data_centered$rate_pop_school_age)
data_centered$deprivation_rate = data_centered$deprivation_rate - mean(data_centered$deprivation_rate)
data_centered$popul_density = data_centered$popul_density - mean(data_centered$popul_density)
data_centered$rate_city_pop = data_centered$rate_city_pop - mean(data_centered$rate_city_pop)
data_centered$rate_lang_non_bg = data_centered$rate_lang_non_bg - mean(data_centered$rate_lang_non_bg)
#regressions
without_secondary_ols <- lm(without_secondary ~
rate_lang_non_bg +
rate_pop_school_age +
teachers_1000_children +
employment_rate +
popul_density +
rate_city_pop +
deprivation_rate,
data = data_centered)
without_secondary_aic <- AIC(without_secondary_ols)
lm_tests <- lm.RStests(without_secondary_ols, lw, test = c("LMlag", "LMerr", "RLMlag", "RLMerr"))
lm_tests
if(!("sf" %in% installed.packages()[,"Package"])) install.packages("sf")
library(sf)
if(!("spdep" %in% installed.packages()[,"Package"])) install.packages("spdep")
library(spdep)
if(!("spatialreg" %in% installed.packages()[,"Package"])) install.packages("spatialreg")
library(spatialreg)
if(!("dplyr" %in% installed.packages()[,"Package"])) install.packages("dplyr")
library(dplyr)
if(!("knitr" %in% installed.packages()[,"Package"])) install.packages("knitr")
library(knitr)
if(!("kableExtra" %in% installed.packages()[,"Package"])) install.packages("kableExtra")
library(kableExtra)
round_table <- function(df,
coef_d = 3,
se_d   = 3,
z_d    = 2,
p_d    = 3) {
df %>%
dplyr::mutate(
Coefficient     = round(Coefficient, coef_d),
`Standard error`= round(`Standard error`, se_d),
`Z-value`       = round(`Z-value`, z_d),
`p-value`       = round(`p-value`, p_d)
)
}
#SET WORKING DIRECTORY
#setwd("")
data <- read.csv("data/bulgaria_data_regressions.csv")
sdm_model <- lagsarlm(
without_secondary ~ rate_lang_non_bg + rate_pop_school_age + teachers_1000_children +
employment_rate + popul_density + rate_city_pop + deprivation_rate,
data = data_centered,
listw = lw,
type = "mixed"   # this fits the SDM
)
summary(sdm_model)
imp <- impacts(sdm_model, listw = lw, R = 1000)  # R = 1000 sims for CI
summary(imp, zstats=TRUE)
direct <- imp$res$direct
indirect <- imp$res$indirect
total <- imp$res$total
vars <- attr(imp, "bnames")  # should be same as colnames(imp$sres$direct)
#sres$direct is 1000 x 7 (samples x variables)
direct_se <- apply(imp$sres$direct, 2, sd)
indirect_se <- apply(imp$sres$indirect, 2, sd)
total_se <- apply(imp$sres$total, 2, sd)
# Names of variables
vars <- attr(imp, "bnames")  # should be same as colnames(imp$sres$direct)
impact_table_direct <- data.frame(
Variable = vars,
Coefficient = round(direct,4),
Standard_Error = round(direct_se,4)
)
impact_table_indirect <- data.frame(
Variable = vars,
Coefficient = round(indirect,4),
Standard_Error = round(indirect_se,4)
)
impact_table_total <- data.frame(
Variable = vars,
Coefficient = round(total,4),
Standard_Error = round(total_se,4)
)
impact_table_direct <- impact_table_direct %>%
dplyr::mutate(
Z_value = Coefficient / Standard_Error,
P_value = 2 * (1 - pnorm(abs(Z_value))),
Significance = dplyr::case_when(P_value < 0.001 ~ "***",
P_value < 0.01 ~ "**",
P_value < 0.05 ~ "*",
TRUE ~ "")
)
impact_table_indirect <- impact_table_indirect %>%
dplyr::mutate(
Z_value = Coefficient / Standard_Error,
P_value = 2 * (1 - pnorm(abs(Z_value))),
Significance = dplyr::case_when(P_value < 0.001 ~ "***",
P_value < 0.01 ~ "**",
P_value < 0.05 ~ "*",
TRUE ~ "")
)
impact_table_total <- impact_table_total %>%
dplyr::mutate(
Z_value = Coefficient / Standard_Error,
P_value = 2 * (1 - pnorm(abs(Z_value))),
Significance = dplyr::case_when(P_value < 0.001 ~ "***",
P_value < 0.01 ~ "**",
P_value < 0.05 ~ "*",
TRUE ~ "")
)
var_labels <- c(
rate_lang_non_bg = "Share of population who declare to not speak Bulgarian as their mother tongue",
rate_pop_school_age = "Share of population aged 7-19",
teachers_1000_children = "Teachers per 1000 children",
employment_rate = "Employment rate",
popul_density = "Population density",
rate_city_pop = "Urbanisation rate",
deprivation_rate = "Share of population experiencing material and/or social deprivation"
)
impact_table_direct$Variable <-
dplyr::recode(impact_table_direct$Variable, !!!var_labels)
impact_table_indirect$Variable <-
dplyr::recode(impact_table_indirect$Variable, !!!var_labels)
impact_table_total$Variable <-
dplyr::recode(impact_table_total$Variable, !!!var_labels)
impact_table_direct <- impact_table_direct %>%
dplyr::rename(
`Standard error` = Standard_Error,
`Z-value` = Z_value,
`p-value` = P_value
)
impact_table_indirect <- impact_table_indirect %>%
dplyr::rename(
`Standard error` = Standard_Error,
`Z-value` = Z_value,
`p-value` = P_value
)
impact_table_total <- impact_table_total %>%
dplyr::rename(
`Standard error` = Standard_Error,
`Z-value` = Z_value,
`p-value` = P_value
)
impact_table_direct  <- round_table(impact_table_direct)
impact_table_indirect <- round_table(impact_table_indirect)
impact_table_total   <- round_table(impact_table_total)
impact_table_direct %>%
kable("html", caption = "Spatial Durbin Model direct impacts", row.names = FALSE, align = c("l", "c", "c", "c", "c", "r")) %>%
footnote(general = "*p<0.05; **p<0.01; ***p<0.001") %>%
kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover")) %>%
save_kable("SDM_Impacts_direct_tongues.html")
impact_table_indirect %>%
kable("html", caption = "Spatial Durbin Model indirect impacts", row.names = FALSE, align = c("l", "c", "c", "c", "c", "r")) %>%
footnote(general = "*p<0.05; **p<0.01; ***p<0.001") %>%
kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover")) %>%
save_kable("SDM_Impacts_indirect_tongues.html")
impact_table_total %>%
kable("html", caption = "Spatial Durbin Model total impacts", row.names = FALSE, align = c("l", "c", "c", "c", "c", "r")) %>%
footnote(general = "*p<0.05; **p<0.01; ***p<0.001") %>%
kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover")) %>%
save_kable("SDM_Impacts_total_tongues.html")
